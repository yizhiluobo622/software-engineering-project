import{d as k,r as y,o as _,c as n,a as s,w,v as h,l as g,F as c,b as v,u as A,f as u,t as d,j as C}from"./index-89733f59.js";import{d as f}from"./db-8a84ae2f.js";function i(o,r){return o?o.toLowerCase().includes(r.toLowerCase()):!1}function b(o,r){return o?{courses:r.courses.filter(e=>i(e.name,o)||i(e.term,o)),resources:r.resources.filter(e=>i(e.title,o)||e.authors.some(a=>i(a,o))),notes:r.notes.filter(e=>i(e.title,o)||i(e.contentMd,o)),tasks:r.tasks.filter(e=>i(e.title,o))}:r}const x={class:"col"},B={class:"row"},L={class:"grid cols-3"},M={class:"panel"},S={class:"panel"},V={class:"muted"},D={class:"panel"},F={class:"panel"},R=k({__name:"Search",setup(o){const r=A(),e=y(String(r.query.q||"")),a=y({courses:[],resources:[],notes:[],tasks:[]});async function p(){const m={courses:await f.courses.toArray(),resources:await f.resources.toArray(),notes:await f.notes.toArray(),tasks:await f.tasks.toArray()};a.value=b(e.value,m)}return _(p),(m,l)=>(u(),n("div",x,[s("div",B,[l[1]||(l[1]=s("div",{class:"h1"},"搜索",-1)),w(s("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>e.value=t),placeholder:"搜索关键字",onKeydown:g(p,["enter"])},null,544),[[h,e.value]]),s("button",{onClick:p},"搜索")]),s("div",L,[s("div",M,[l[2]||(l[2]=s("div",{class:"h3"},"课程",-1)),s("ul",null,[(u(!0),n(c,null,v(a.value.courses,t=>(u(),n("li",{key:t.id},d(t.name),1))),128))])]),s("div",S,[l[3]||(l[3]=s("div",{class:"h3"},"资源",-1)),s("ul",null,[(u(!0),n(c,null,v(a.value.resources,t=>(u(),n("li",{key:t.id},[C(d(t.title)+" ",1),s("span",V,"("+d(t.type)+")",1)]))),128))])]),s("div",D,[l[4]||(l[4]=s("div",{class:"h3"},"笔记",-1)),s("ul",null,[(u(!0),n(c,null,v(a.value.notes,t=>(u(),n("li",{key:t.id},d(t.title),1))),128))])])]),s("div",F,[l[5]||(l[5]=s("div",{class:"h3"},"任务",-1)),s("ul",null,[(u(!0),n(c,null,v(a.value.tasks,t=>(u(),n("li",{key:t.id},d(t.title),1))),128))])])]))}});export{R as default};
