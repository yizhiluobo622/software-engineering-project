import{d as S,r as v,o as T,m as C,c as o,a as t,w as g,v as y,k as b,F as k,b as w,f as l,t as u,j as x}from"./index-89733f59.js";import{l as A,c as M,u as V,r as $}from"./tasks-02814935.js";import"./db-8a84ae2f.js";import"./id-0d1586fb.js";function B(){const c=new Date,n=c.getFullYear(),i=String(c.getMonth()+1).padStart(2,"0"),d=String(c.getDate()).padStart(2,"0");return`${n}-${i}-${d}`}const F={class:"col"},U={class:"panel row"},j={class:"grid cols-2"},L={class:"panel"},N=["checked","onChange"],O={class:"muted"},Y={class:"tag"},E=["onClick"],I={class:"panel"},q={class:"tag"},K=S({__name:"Tasks",setup(c){const n=v(""),i=v(B()),d=v("mid"),m=v([]);async function p(){m.value=await A()}T(p);async function f(){if(!n.value.trim())return;const a=i.value?new Date(i.value).getTime():void 0;await M({title:n.value.trim(),dueAt:a,priority:d.value}),n.value="",await p()}async function _(a){await V(a.id,{done:!a.done}),await p()}async function h(a){await $(a),await p()}const D=C(()=>{const a={};for(const s of m.value){const e=s.dueAt?new Date(s.dueAt).toISOString().slice(0,10):"无日期";a[e]=a[e]||[],a[e].push(s)}return Object.keys(a).sort().map(s=>({date:s,items:a[s]}))});return(a,s)=>(l(),o("div",F,[s[6]||(s[6]=t("div",{class:"row"},[t("div",{class:"h1"},"任务"),t("span",{class:"muted"},"待办与简易日历")],-1)),t("div",U,[g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.value=e),placeholder:"任务标题"},null,512),[[y,n.value]]),g(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),type:"date"},null,512),[[y,i.value]]),g(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>d.value=e)},[...s[3]||(s[3]=[t("option",{value:"low"},"低",-1),t("option",{value:"mid"},"中",-1),t("option",{value:"high"},"高",-1)])],512),[[b,d.value]]),t("button",{onClick:f},"添加")]),t("div",j,[t("div",L,[s[4]||(s[4]=t("div",{class:"h3"},"列表",-1)),t("ul",null,[(l(!0),o(k,null,w(m.value,e=>(l(),o("li",{key:e.id,class:"row"},[t("input",{type:"checkbox",checked:e.done,onChange:r=>_(e)},null,40,N),t("span",null,u(e.title),1),t("span",O,u(e.dueAt?new Date(e.dueAt).toLocaleDateString():"-"),1),t("span",Y,u(e.priority),1),t("button",{class:"danger",onClick:r=>h(e.id)},"删除",8,E)]))),128))])]),t("div",I,[s[5]||(s[5]=t("div",{class:"h3"},"简易日历",-1)),t("ul",null,[(l(!0),o(k,null,w(D.value,e=>(l(),o("li",{key:e.date},[t("strong",null,u(e.date),1),t("ul",null,[(l(!0),o(k,null,w(e.items,r=>(l(),o("li",{key:r.id},[x(u(r.title)+" ",1),t("span",q,u(r.priority),1)]))),128))])]))),128))])])])]))}});export{K as default};
